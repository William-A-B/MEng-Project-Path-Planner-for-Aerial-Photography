polygon_vertices = [
    53.950974807525206, -1.0329672619323844, 50;
    53.946024591620926, -1.033224753997814, 50;
    53.945898302917456, -1.0243412777404899, 50;
    53.95089904334211, -1.0251566692810172, 50;
    53.950974807525206, -1.0329672619323844, 50 % Close the loop
];

polygon_vertices = [
    53.95375719839131, -1.0404824359104623, 50;
    53.953479414248854, -1.0314702136204232, 50;
    53.955802642820856, -1.017866049496888, 50;
    53.95610566309161, -1.012201224057435, 50;
    53.95251978206389, -1.0120295626804818, 50;
    53.94810013827757, -1.0145615679905404, 50;
    53.94537235295549, -1.0177802188084115, 50;
    53.94403365231053, -1.0391819005778586, 50;
    53.94630689209062, -1.0445463186076438, 50;
    53.94802436887196, -1.0405122762492454, 50;
    53.948504239449356, -1.0390531545451438, 50;
    53.950019583972534, -1.0408770566752708, 50;
    53.95375719839131, -1.0434519773295676, 50;
    53.95375719839131, -1.0404824359104623, 50; % Close the loop
];

start_pos = [53.95375719839131, -1.0404824359104623, 50];
goal_pos = [53.94537235295549, -1.0177802188084115, 50];

wind_direction = -pi/2;

altitude_limits.min = 20;
altitude_limits.max = 1000;

num_divisions.x = 12;
num_divisions.y = 12;
num_divisions.z = 3;

plot_results = true;

[coordinate_path, dubins_path_waypoints] = setupTSP(start_pos, goal_pos, polygon_vertices, wind_direction, altitude_limits, num_divisions, plot_results);